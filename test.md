# TX-LCN 5.0.0.RC2 性能测试报告

## 方式说明

SpringCloud下测试:   
S1. 在SpringCloud下测试单LCN模块在并发100、1000情况下循环请求的吞吐能力。   
S2. 在SpringCloud下测试单TXC模块在并发100、1000情况下循环请求的吞吐能力。   
S3. 在SpringCloud下测试单TCC模块在并发100、1000情况下循环请求的吞吐能力。   
S4. 在SpringCloud下测试TCC、TXC、LCN混合模块下在并发100、1000情况下循环请求的吞吐能力。   
S5. 在SpringCloud下测试本地事务在并发100、1000情况下循环请求的吞吐能力。   

Dubbo下测试:   
D1. 在Dubbo下测试单LCN模块在并发100、1000情况下循环请求的吞吐能力。   
D2. 在Dubbo下测试单TXC模块在并发100、1000情况下循环请求的吞吐能力。   
D3. 在Dubbo下测试单TCC模块在并发100、1000情况下循环请求的吞吐能力。   
D4. 在Dubbo下测试TCC、TXC、LCN混合模块下在并发100、1000情况下循环请求的吞吐能力。   
D5. 在Dubbo下测试本地事务在并发100、1000情况下循环请求的吞吐能力。   


## 测试环境

硬件环境:
CPU: Intel(R) Core(TM) I5-8400 CPU @ 2.80GHz 2.81GHz   
内存: 16G   
硬盘：240G SSD    


软件环境:
系统:win10 64   
JAVA: 1.8.0_181  
Mysql: 5.7.23   
Consul: 1.2.3   
Zookeeper:3.4.9  
Dubbo:2.6.2
SpringCloud:Finchley.SR2



## 测试模块

Client D E 三个模块,Client调用一次D模块在调用一次E模块。  

Client.sayHello() -> D.rpc();   
Client.sayHello() -> E.rpc();   


### 重要配置信息

采用jmeter做的压测

线程配置
![](img/jmeter.png)
结果取值
![](img/jmeter-res.png)

jvm  -Xms256m -Xmx512m    
连接池大小 均100    
分布式事务框架未启用logger记录  



## 测试结果


| 项目   |     线程数    |  Ramp-up时间(s)    | 持续时间(s)   | 样本数   |  吞吐量 | 平均响应(ms) | 错误率(%) | 成功条数 |
|----------|:-------------:|:-------------:|:-------------:|------:|------:|------:|------:|------:|
| S1 | 100 | 1 | 120 |24354 |202.4/sec | 491 | 0.00% |24354 |
| S1 | 1000 | 1 | 124 |23744 |190.7/sec | 5120 | 0.00% |23744 |
| S2 | 100 | 1 | 120 |17358 |144.1/sec | 690 | 0.00% |17358 |
| S2 | 1000 | 1 | 126 |17529 |138.4/sec | 7017 | 0.00% |17529 |
| S3 | 100 | 1 | 120 |26409 |219.5/sec | 452 | 0.00% |26409 |
| S3 | 1000 | 1 | 124 |25666 |205.8/sec | 7452 | 0.00% |25666 |
| S4 | 100 | 1 | 120 |22362 |185.9/sec | 534 | 0.00% |22362 |
| S4 | 1000 | 1 | 124 |23651 |189.1.8/sec | 5151 | 0.00% |23651 |
| S5 | 100 | 1 | 20 |12703 |631.8/sec | 153 | 0.00% |12703 |
| S5 | 1000 | 1 | 21 |11869 |548.0/sec | 1703 | 0.00% |11869 |



| 项目   |     线程数    |  Ramp-up时间(s)    | 持续时间(s)   | 样本数   |  吞吐量 | 平均响应(ms) | 错误率(%) | 成功条数 |
|----------|:-------------:|:-------------:|:-------------:|------:|------:|------:|------:|------:|
| D1 | 100 | 1 | 120 |33412 |277.6/sec | 357 | 0.00% |33412 |
| D1 | 1000 | 1 | 123 |30482 |246.0/sec | 3977 | 0.00% |30482 |
| D2 | 100 | 1 | 120 |27720 |230.4/sec | 431 | 0.44% |27597 |
| D2 | 1000 | 1 | 124 |27379 |220.5/sec | 4430 | 0.26% |27307 |
| D3 | 100 | 1 | 120 |59194 |492.8/sec | 201 | 0.00% |59194 |
| D3 | 1000 | 1 | 123 |54377 |443.5/sec | 2214 | 0.00% |54377 |
| D4 | 100 | 1 | 120 |35637 |296.3/sec | 335 | 0.06% |35617 |
| D4 | 1000 | 1 | 124 |32220 |259.8/sec | 3768 | 0.52% |32053 |
| D5 | 100 | 1 | 40 |34769 |867.6/sec | 113 | 0.00% |34769 |
| D5 | 1000 | 1 | 41 |29352 |712.9/sec | 1359 | 0.00% |29352 |

补充说明 

* 所有的模块开启分布式事务以后数据一致性均没问题，在本地事务的情况下会出现数据不一致的情况。
* 本地事务由于请求量过大会导致数据不一致，为了兼任数据一致性的情况，将本地事务的循环时间缩短了。
* 由于都是在本地的PC上做的测试，可能会因系统稳定性原因导致存在数据准确性的误差，可参考本地事务的吞吐量做对比。





